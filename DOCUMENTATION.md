# ğŸš¦ Smart Traffic Light System - DocumentaÈ›ie CompletÄƒ

## Cuprins
1. [Descriere GeneralÄƒ](#descriere-generalÄƒ)
2. [Arhitectura Sistemului](#arhitectura-sistemului)
3. [Schema Bloc Hardware](#schema-bloc-hardware)
4. [Schema Bloc Software](#schema-bloc-software)
5. [Schema Bloc FinalÄƒ](#schema-bloc-finalÄƒ)
6. [Module Software](#module-software)
7. [Fluxul de Date](#fluxul-de-date)
8. [Algoritmi ImplementaÈ›i](#algoritmi-implementaÈ›i)
9. [FuncÈ›ionalitÄƒÈ›i Implementate](#funcÈ›ionalitÄƒÈ›i-implementate)
10. [FuncÈ›ionalitÄƒÈ›i Propuse pentru Viitor](#funcÈ›ionalitÄƒÈ›i-propuse-pentru-viitor)

---

## Descriere GeneralÄƒ

Sistemul **Smart Traffic Light** este un sistem inteligent de control al semaforului bazat pe detectarea vehiculelor Ã®n timp real folosind viziune computerizatÄƒ È™i inteligenÈ›Äƒ artificialÄƒ. Sistemul ruleazÄƒ pe **Raspberry Pi 5** È™i utilizeazÄƒ **Camera Module 3** pentru captura video, **YOLOv8-nano** pentru detectarea obiectelor È™i o **bandÄƒ LED NeoPixel** pentru afiÈ™area stÄƒrii semaforului.

### Caracteristici Principale:
- DetecÈ›ie Ã®n timp real a vehiculelor folosind AI (YOLOv8)
- Control adaptiv al semaforului bazat pe densitatea traficului
- Suport pentru camerÄƒ secundarÄƒ (DroidCam - telefon mobil)
- Mod Pedestrian Phone - detectare vehicule de pe telefon pentru traversare
- InterfaÈ›Äƒ web responsive pentru monitorizare È™i control
- AnalizÄƒ È™i predicÈ›ie trafic cu date istorice
- Integrare cu date meteo

---

## Arhitectura Sistemului

### Componente Hardware:
| ComponentÄƒ            | Descriere                                  |
| --------------------- | ------------------------------------------ |
| Raspberry Pi 5        | Unitatea centralÄƒ de procesare             |
| Camera Module 3       | CamerÄƒ principalÄƒ pentru detecÈ›ie vehicule |
| LED Strip WS2812B     | BandÄƒ LED 8 pixeli pentru afiÈ™are semafor  |
| Smartphone (opÈ›ional) | CamerÄƒ secundarÄƒ via DroidCam              |

### Componente Software:
| ComponentÄƒ   | Tehnologie                |
| ------------ | ------------------------- |
| Backend      | Django 5.2 (Python)       |
| AI/ML        | YOLOv8-nano (Ultralytics) |
| Frontend     | HTML5, CSS3, JavaScript   |
| BazÄƒ de Date | SQLite                    |
| LED Control  | rpi_ws281x (NeoPixel)     |

---

## Schema Bloc Hardware

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           SCHEMA BLOC HARDWARE                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   CAMERA         â”‚         â”‚   SMARTPHONE     â”‚
    â”‚   MODULE 3       â”‚         â”‚   (DroidCam)     â”‚
    â”‚                  â”‚         â”‚                  â”‚
    â”‚  â€¢ 12MP Sensor   â”‚         â”‚  â€¢ WiFi Stream   â”‚
    â”‚  â€¢ CSI Interface â”‚         â”‚  â€¢ HTTP Video    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                            â”‚
             â”‚ CSI Ribbon Cable           â”‚ WiFi (HTTP)
             â”‚                            â”‚
             â–¼                            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                 â”‚
    â”‚              RASPBERRY PI 5                     â”‚
    â”‚                                                 â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
    â”‚  â”‚ CSI Port    â”‚    â”‚ WiFi Module         â”‚    â”‚
    â”‚  â”‚ (Camera In) â”‚    â”‚ (Network Interface) â”‚    â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
    â”‚         â”‚                      â”‚               â”‚
    â”‚         â–¼                      â–¼               â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
    â”‚  â”‚         CPU + GPU Processing         â”‚     â”‚
    â”‚  â”‚                                      â”‚     â”‚
    â”‚  â”‚  â€¢ Video Capture (libcamera/OpenCV)  â”‚     â”‚
    â”‚  â”‚  â€¢ YOLOv8 Detection (AI)             â”‚     â”‚
    â”‚  â”‚  â€¢ Traffic Logic                     â”‚     â”‚
    â”‚  â”‚  â€¢ Django Web Server                 â”‚     â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
    â”‚                    â”‚                          â”‚
    â”‚                    â–¼                          â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
    â”‚  â”‚           GPIO 10 (SPI MOSI)         â”‚     â”‚
    â”‚  â”‚           PWM Data Signal            â”‚     â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
    â”‚                                                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ Data Signal (800kHz PWM)
                         â”‚
                         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                 â”‚
    â”‚           LED STRIP WS2812B (8 LED)             â”‚
    â”‚                                                 â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
    â”‚   â”‚ LED â”‚ LED â”‚ LED â”‚ YEL â”‚ YEL â”‚ GRN â”‚ GRN â”‚ GRN â”‚
    â”‚   â”‚ RED â”‚ RED â”‚ RED â”‚ LOW â”‚ LOW â”‚     â”‚     â”‚     â”‚
    â”‚   â”‚  0  â”‚  1  â”‚  2  â”‚  3  â”‚  4  â”‚  5  â”‚  6  â”‚  7  â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
    â”‚                                                 â”‚
    â”‚   Alimentare: 5V DC, GND comun cu RPi           â”‚
    â”‚                                                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                         â”‚
                         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚              BROWSER (CLIENT)                   â”‚
    â”‚                                                 â”‚
    â”‚  â€¢ Dashboard - Monitorizare Ã®n timp real        â”‚
    â”‚  â€¢ Analytics - Grafice È™i statistici            â”‚
    â”‚  â€¢ Settings - Configurare sistem                â”‚
    â”‚                                                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Conexiuni Hardware:

| Pin RPi 5 | FuncÈ›ie         | ComponentÄƒ      |
| --------- | --------------- | --------------- |
| GPIO 10   | SPI MOSI (Data) | LED Strip DIN   |
| 5V        | Alimentare      | LED Strip VCC   |
| GND       | Ground          | LED Strip GND   |
| CSI Port  | Video           | Camera Module 3 |

---

## Schema Bloc Software

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           SCHEMA BLOC SOFTWARE                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              LAYER: FRONTEND                                 â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   DASHBOARD     â”‚  â”‚   ANALYTICS     â”‚  â”‚   SETTINGS      â”‚             â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚             â”‚
â”‚  â”‚ â€¢ Live Video    â”‚  â”‚ â€¢ Grafice       â”‚  â”‚ â€¢ LED Control   â”‚             â”‚
â”‚  â”‚ â€¢ LED Status    â”‚  â”‚ â€¢ Heatmap       â”‚  â”‚ â€¢ DetecÈ›ie      â”‚             â”‚
â”‚  â”‚ â€¢ Car Counter   â”‚  â”‚ â€¢ Peak Hours    â”‚  â”‚ â€¢ Algorithm     â”‚             â”‚
â”‚  â”‚ â€¢ Event Log     â”‚  â”‚ â€¢ Export CSV    â”‚  â”‚ â€¢ Camera        â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚           â”‚                    â”‚                    â”‚                       â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                â”‚                                            â”‚
â”‚                                â–¼                                            â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚                    â”‚   JavaScript (AJAX)   â”‚                               â”‚
â”‚                    â”‚   Fetch API Calls     â”‚                               â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚ HTTP/REST API
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              LAYER: BACKEND                                  â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                         DJANGO WEB SERVER                              â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚ â”‚
â”‚  â”‚  â”‚                      URL ROUTER (urls.py)                     â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ /camera/feed/          â†’ Video Stream                      â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ /camera/detection/     â†’ DetecÈ›ie Toggle                   â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ /camera/traffic/       â†’ Control Semafor                   â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ /camera/analytics/     â†’ Date Statistice                   â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ /camera/droidcam/      â†’ CamerÄƒ SecundarÄƒ                  â”‚     â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â”‚
â”‚  â”‚                                â”‚                                       â”‚ â”‚
â”‚  â”‚                                â–¼                                       â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚ â”‚
â”‚  â”‚  â”‚                      VIEWS (views.py)                         â”‚     â”‚ â”‚
â”‚  â”‚  â”‚                                                               â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  PrimeÈ™te request-uri HTTP, proceseazÄƒ È™i returneazÄƒ         â”‚     â”‚ â”‚
â”‚  â”‚  â”‚  rÄƒspunsuri JSON sau stream-uri video                        â”‚     â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â”‚
â”‚  â”‚                                â”‚                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                   â”‚                                         â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚           â”‚                       â”‚                       â”‚                â”‚
â”‚           â–¼                       â–¼                       â–¼                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ CAMERA MODULE   â”‚  â”‚ DETECTOR MODULE â”‚  â”‚ HARDWARE MODULE â”‚            â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚            â”‚
â”‚  â”‚ â€¢ CaptureazÄƒ    â”‚  â”‚ â€¢ YOLOv8 Model  â”‚  â”‚ â€¢ LED Strip     â”‚            â”‚
â”‚  â”‚   frame-uri     â”‚  â”‚ â€¢ DetecteazÄƒ    â”‚  â”‚   Control       â”‚            â”‚
â”‚  â”‚ â€¢ Stream video  â”‚  â”‚   vehicule      â”‚  â”‚ â€¢ GPIO 10       â”‚            â”‚
â”‚  â”‚ â€¢ DroidCam      â”‚  â”‚ â€¢ NumÄƒrÄƒ maÈ™ini â”‚  â”‚ â€¢ NeoPixel PWM  â”‚            â”‚
â”‚  â”‚   integration   â”‚  â”‚ â€¢ Zone ROI      â”‚  â”‚                 â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚           â”‚                    â”‚                    â”‚                      â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                â”‚                                           â”‚
â”‚                                â–¼                                           â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚           â”‚          TRAFFIC CONTROLLER                 â”‚                   â”‚
â”‚           â”‚                                            â”‚                   â”‚
â”‚           â”‚  â€¢ Algoritm inteligent de semaforizare     â”‚                   â”‚
â”‚           â”‚  â€¢ Prioritate vehicule vs pietoni          â”‚                   â”‚
â”‚           â”‚  â€¢ Calculare timp verde/roÈ™u               â”‚                   â”‚
â”‚           â”‚  â€¢ Event logging                           â”‚                   â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                â”‚                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              LAYER: DATABASE                                 â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                         SQLite (db.sqlite3)                           â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚ â”‚
â”‚  â”‚  â”‚VehicleCount â”‚ â”‚DetectionEvt â”‚ â”‚TrafficLight â”‚ â”‚SystemStats  â”‚     â”‚ â”‚
â”‚  â”‚  â”‚             â”‚ â”‚             â”‚ â”‚   State     â”‚ â”‚             â”‚     â”‚ â”‚
â”‚  â”‚  â”‚â€¢ timestamp  â”‚ â”‚â€¢ timestamp  â”‚ â”‚â€¢ state      â”‚ â”‚â€¢ date       â”‚     â”‚ â”‚
â”‚  â”‚  â”‚â€¢ north_cnt  â”‚ â”‚â€¢ event_type â”‚ â”‚â€¢ direction  â”‚ â”‚â€¢ total_veh  â”‚     â”‚ â”‚
â”‚  â”‚  â”‚â€¢ east_cnt   â”‚ â”‚â€¢ direction  â”‚ â”‚â€¢ triggered  â”‚ â”‚â€¢ ped_req    â”‚     â”‚ â”‚
â”‚  â”‚  â”‚â€¢ south_cnt  â”‚ â”‚â€¢ vehicle_ct â”‚ â”‚             â”‚ â”‚             â”‚     â”‚ â”‚
â”‚  â”‚  â”‚â€¢ west_cnt   â”‚ â”‚â€¢ message    â”‚ â”‚             â”‚ â”‚             â”‚     â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚ â”‚
â”‚  â”‚  â”‚HourlyStats  â”‚ â”‚WeatherData  â”‚ â”‚CameraSource â”‚ â”‚SystemSettngsâ”‚     â”‚ â”‚
â”‚  â”‚  â”‚             â”‚ â”‚             â”‚ â”‚             â”‚ â”‚             â”‚     â”‚ â”‚
â”‚  â”‚  â”‚â€¢ date       â”‚ â”‚â€¢ condition  â”‚ â”‚â€¢ name       â”‚ â”‚â€¢ droidcam   â”‚     â”‚ â”‚
â”‚  â”‚  â”‚â€¢ hour       â”‚ â”‚â€¢ temperatureâ”‚ â”‚â€¢ camera_typ â”‚ â”‚â€¢ flip_h/v   â”‚     â”‚ â”‚
â”‚  â”‚  â”‚â€¢ total_veh  â”‚ â”‚â€¢ humidity   â”‚ â”‚â€¢ url        â”‚ â”‚â€¢ rotation   â”‚     â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Schema Bloc FinalÄƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SCHEMA BLOC FINALÄ‚ - FLUX DATE                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚           INPUT SENZORI             â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                         â”‚                         â”‚
           â–¼                         â–¼                         â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   CAMERA      â”‚        â”‚   DROIDCAM    â”‚        â”‚   BUTON       â”‚
   â”‚   MODULE 3    â”‚        â”‚   (Telefon)   â”‚        â”‚   PIETON      â”‚
   â”‚               â”‚        â”‚               â”‚        â”‚               â”‚
   â”‚ CapturÄƒ video â”‚        â”‚ Stream WiFi   â”‚        â”‚ Request       â”‚
   â”‚ 1920x1080     â”‚        â”‚ HTTP/MJPEG    â”‚        â”‚ Traversare    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                        â”‚                        â”‚
           â”‚ Frame-uri              â”‚ Frame-uri              â”‚ Signal
           â”‚ video                  â”‚ video                  â”‚ boolean
           â”‚                        â”‚                        â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                                                 â”‚
           â”‚              MODUL PROCESARE VIDEO              â”‚
           â”‚                   (camera/)                     â”‚
           â”‚                                                 â”‚
           â”‚  â€¢ PrimeÈ™te frame-uri de la camere              â”‚
           â”‚  â€¢ RedimensioneazÄƒ la 640x480 pentru AI         â”‚
           â”‚  â€¢ Trimite cÄƒtre modulul de detecÈ›ie            â”‚
           â”‚  â€¢ GenereazÄƒ MJPEG stream pentru browser        â”‚
           â”‚                                                 â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ Frame-uri procesate
                                    â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                                                 â”‚
           â”‚              MODUL DETECÈšIE AI                  â”‚
           â”‚                  (detector/)                    â”‚
           â”‚                                                 â”‚
           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
           â”‚  â”‚           YOLOv8-nano Model             â”‚   â”‚
           â”‚  â”‚                                         â”‚   â”‚
           â”‚  â”‚  â€¢ DetecteazÄƒ: car, truck, bus,         â”‚   â”‚
           â”‚  â”‚    motorcycle, bicycle, person          â”‚   â”‚
           â”‚  â”‚  â€¢ ReturneazÄƒ bounding boxes            â”‚   â”‚
           â”‚  â”‚  â€¢ Confidence score > 0.5               â”‚   â”‚
           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
           â”‚                                                 â”‚
           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
           â”‚  â”‚           Zone Detection (ROI)          â”‚   â”‚
           â”‚  â”‚                                         â”‚   â”‚
           â”‚  â”‚  â€¢ Ãmparte frame Ã®n 4 zone:             â”‚   â”‚
           â”‚  â”‚    NORTH, EAST, SOUTH, WEST             â”‚   â”‚
           â”‚  â”‚  â€¢ NumÄƒrÄƒ vehicule per direcÈ›ie         â”‚   â”‚
           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
           â”‚                                                 â”‚
           â”‚  OUTPUT: {north: 2, east: 0, south: 1, west: 3} â”‚
           â”‚                                                 â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ Date detecÈ›ie
                                    â”‚ (nr. vehicule/direcÈ›ie)
                                    â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                                                 â”‚
           â”‚            TRAFFIC CONTROLLER                   â”‚
           â”‚          (detector/traffic_controller.py)       â”‚
           â”‚                                                 â”‚
           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
           â”‚  â”‚      ALGORITM INTELIGENT SEMAFORIZARE   â”‚   â”‚
           â”‚  â”‚                                         â”‚   â”‚
           â”‚  â”‚  1. CalculeazÄƒ scor prioritate:         â”‚   â”‚
           â”‚  â”‚     score = vehicles Ã— CAR_WEIGHT       â”‚   â”‚
           â”‚  â”‚           + wait_time Ã— TIME_BONUS      â”‚   â”‚
           â”‚  â”‚                                         â”‚   â”‚
           â”‚  â”‚  2. Prioritate maÈ™ini > pietoni         â”‚   â”‚
           â”‚  â”‚     (T_CAR_MIN_GREEN = 15s)             â”‚   â”‚
           â”‚  â”‚     (T_PEDESTRIAN_MIN_WAIT = 20s)       â”‚   â”‚
           â”‚  â”‚                                         â”‚   â”‚
           â”‚  â”‚  3. Balansare trafic:                   â”‚   â”‚
           â”‚  â”‚     - DetecteazÄƒ blocare                â”‚   â”‚
           â”‚  â”‚     - SchimbÄƒ direcÈ›ie dacÄƒ e necesar   â”‚   â”‚
           â”‚  â”‚                                         â”‚   â”‚
           â”‚  â”‚  4. Decide stare semafor:               â”‚   â”‚
           â”‚  â”‚     GREEN â†’ YELLOW â†’ RED                â”‚   â”‚
           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
           â”‚                                                 â”‚
           â”‚  OUTPUT: ComandÄƒ LED (RED/YELLOW/GREEN)         â”‚
           â”‚                                                 â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                        â”‚                        â”‚
           â–¼                        â–¼                        â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   LED STRIP   â”‚       â”‚   DATABASE    â”‚       â”‚   WEB CLIENT  â”‚
   â”‚   CONTROL     â”‚       â”‚   LOGGING     â”‚       â”‚   UPDATE      â”‚
   â”‚               â”‚       â”‚               â”‚       â”‚               â”‚
   â”‚ SeteazÄƒ culoareâ”‚       â”‚ SalveazÄƒ:     â”‚       â”‚ Trimite JSON: â”‚
   â”‚ pe banda LED  â”‚       â”‚ â€¢ VehicleCountâ”‚       â”‚ â€¢ Stare LED   â”‚
   â”‚               â”‚       â”‚ â€¢ Events      â”‚       â”‚ â€¢ Nr. maÈ™ini  â”‚
   â”‚ GPIO 10 â†’     â”‚       â”‚ â€¢ Stats       â”‚       â”‚ â€¢ Events      â”‚
   â”‚ NeoPixel PWM  â”‚       â”‚               â”‚       â”‚               â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                               â”‚
           â–¼                                               â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚               â”‚                              â”‚               â”‚
   â”‚   8 LED-uri   â”‚                              â”‚   BROWSER     â”‚
   â”‚   WS2812B     â”‚                              â”‚   Dashboard   â”‚
   â”‚               â”‚                              â”‚               â”‚
   â”‚ [R][R][R]     â”‚                              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
   â”‚ [Y][Y]        â”‚                              â”‚ â”‚ Live Feed â”‚ â”‚
   â”‚ [G][G][G]     â”‚                              â”‚ â”‚ Stats     â”‚ â”‚
   â”‚               â”‚                              â”‚ â”‚ Controls  â”‚ â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## Module Software

### 1. Modulul Camera (`camera/`)

**FuncÈ›ie:** PrimeÈ™te date video de la camerele conectate È™i le proceseazÄƒ pentru afiÈ™are È™i detecÈ›ie.

| FiÈ™ier        | Descriere                                               |
| ------------- | ------------------------------------------------------- |
| `views.py`    | Endpoint-uri API pentru video feed, control, statistici |
| `droidcam.py` | ClasÄƒ pentru conectare la camerÄƒ smartphone             |
| `urls.py`     | Rutare URL-uri cÄƒtre funcÈ›ii view                       |
| `templates/`  | FiÈ™iere HTML pentru interfaÈ›a web                       |

**Flux de date:**
```
Camera Hardware â†’ Frame Capture â†’ Resize â†’ YOLO Detection â†’ Annotate â†’ MJPEG Stream â†’ Browser
```

### 2. Modulul Detector (`detector/`)

**FuncÈ›ie:** PrimeÈ™te frame-uri video, ruleazÄƒ modelul AI pentru detectarea vehiculelor È™i returneazÄƒ rezultatele.

| FiÈ™ier                   | Descriere                          |
| ------------------------ | ---------------------------------- |
| `yolo_detector.py`       | Wrapper pentru modelul YOLOv8-nano |
| `pedestrian_detector.py` | Detector specific pentru pietoni   |
| `traffic_controller.py`  | Logica de control a semaforului    |

**Clase principale:**
- `YOLODetector` - ÃncarcÄƒ model, ruleazÄƒ inferenÈ›Äƒ, returneazÄƒ detecÈ›ii
- `TrafficController` - Algoritm de semaforizare inteligentÄƒ

### 3. Modulul Detection (`detection/`)

**FuncÈ›ie:** DefineÈ™te structura bazei de date È™i modelele ORM pentru stocare.

| Model               | Descriere                                           |
| ------------------- | --------------------------------------------------- |
| `VehicleCount`      | NumÄƒr vehicule per direcÈ›ie È™i timestamp            |
| `DetectionEvent`    | Evenimente de detecÈ›ie (vehicule, pietoni, urgenÈ›e) |
| `TrafficLightState` | Istoricul schimbÄƒrilor de stare LED                 |
| `SystemStats`       | Statistici zilnice agregate                         |
| `HourlyStats`       | Statistici per orÄƒ pentru analizÄƒ                   |
| `WeatherData`       | Date meteo pentru corelaÈ›ie trafic                  |
| `SystemSettings`    | SetÄƒri persistente (DroidCam, flip camera, etc.)    |

### 4. Modulul Hardware (`hardware/`)

**FuncÈ›ie:** ControleazÄƒ banda LED NeoPixel prin GPIO.

| FiÈ™ier                | Descriere                                     |
| --------------------- | --------------------------------------------- |
| `led_strip.py`        | ClasÄƒ completÄƒ pentru control LED cu animaÈ›ii |
| `led_strip_simple.py` | Versiune simplificatÄƒ pentru control de bazÄƒ  |

**Configurare LED:**
```python
LED_COUNT = 8
GPIO_PIN = 10  # SPI MOSI pentru RPi 5
LED_MAPPING = {
    'RED': [0, 1, 2],      # LED-uri 0-2
    'YELLOW': [3, 4],      # LED-uri 3-4
    'GREEN': [5, 6, 7]     # LED-uri 5-7
}
```

---

## Fluxul de Date

### Flux Principal (DetecÈ›ie â†’ LED):

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Camera  â”‚â”€â”€â”€â–¶â”‚  OpenCV  â”‚â”€â”€â”€â–¶â”‚  YOLOv8  â”‚â”€â”€â”€â–¶â”‚ Traffic  â”‚â”€â”€â”€â–¶â”‚   LED    â”‚
â”‚  Module  â”‚    â”‚  Capture â”‚    â”‚ Detector â”‚    â”‚Controllerâ”‚    â”‚  Strip   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚               â”‚               â”‚               â”‚               â”‚
     â”‚               â”‚               â”‚               â”‚               â”‚
  Frame          Resize          DetecÈ›ii        Decizie          PWM
  1080p          640x480        [car, bus]      GREEN/RED       Signal
```

### Flux Web (Browser â†’ Server â†’ Browser):

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Browser â”‚â”€â”€â”€â–¶â”‚  Django  â”‚â”€â”€â”€â–¶â”‚  Views   â”‚â”€â”€â”€â–¶â”‚  JSON    â”‚â”€â”€â”€â–¶ Browser
â”‚  Request â”‚    â”‚  Router  â”‚    â”‚ Function â”‚    â”‚ Response â”‚    Update UI
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Algoritmi ImplementaÈ›i

### 1. Algoritm DetecÈ›ie Vehicule

```python
# Pseudo-cod
for frame in video_stream:
    detections = yolo_model.detect(frame)
    
    for detection in detections:
        if detection.class in ['car', 'truck', 'bus', 'motorcycle']:
            zone = get_zone(detection.center)  # N/E/S/W
            vehicle_counts[zone] += 1
    
    return vehicle_counts
```

### 2. Algoritm Semaforizare InteligentÄƒ

```python
# Pseudo-cod simplificat
def calculate_priority(direction, vehicles, wait_time):
    score = vehicles * CAR_WEIGHT  # Greutate per vehicul
    score += wait_time * TIME_BONUS  # Bonus pentru aÈ™teptare
    return score

def decide_next_state():
    if pedestrian_waiting and wait_time > T_PEDESTRIAN_MAX_WAIT:
        return RED  # Prioritate pieton dupÄƒ aÈ™teptare lungÄƒ
    
    if current_green_time < T_CAR_MIN_GREEN:
        return current_state  # MenÈ›ine verde minim pentru maÈ™ini
    
    scores = {dir: calculate_priority(dir) for dir in directions}
    best_direction = max(scores, key=scores.get)
    
    if best_direction != current_direction:
        return YELLOW  # TranziÈ›ie
    
    return GREEN  # ContinuÄƒ verde
```

### 3. Constante Algoritm

| ConstantÄƒ               | Valoare | Descriere                                |
| ----------------------- | ------- | ---------------------------------------- |
| `T_CAR_MIN_GREEN`       | 15s     | Timp minim verde pentru maÈ™ini           |
| `T_CAR_MAX_GREEN`       | 60s     | Timp maxim verde                         |
| `T_PEDESTRIAN_MIN_WAIT` | 20s     | MaÈ™inile au prioritate primele 20s       |
| `T_PEDESTRIAN_MAX_WAIT` | 120s    | DupÄƒ 2 min, pietonul primeÈ™te prioritate |
| `CAR_WEIGHT`            | 10      | Puncte per vehicul                       |
| `WAITING_TIME_BONUS`    | 2       | Puncte per secundÄƒ aÈ™teptare             |

---

## FuncÈ›ionalitÄƒÈ›i Implementate

### âœ… Core Features
- [x] DetecÈ›ie vehicule Ã®n timp real cu YOLOv8-nano
- [x] Control LED NeoPixel 8 pixeli pe GPIO 10
- [x] InterfaÈ›Äƒ web responsive (Dashboard, Analytics, Settings)
- [x] Stream video MJPEG Ã®n browser
- [x] NumÄƒrare vehicule pe 4 direcÈ›ii (N/E/S/W)

### âœ… Advanced Features
- [x] Algoritm inteligent de semaforizare cu prioritate maÈ™ini
- [x] Integrare DroidCam (camerÄƒ smartphone)
- [x] Mod Pedestrian Phone (telefon detecteazÄƒ maÈ™ini pentru traversare)
- [x] Salvare persistentÄƒ setÄƒri DroidCam (URL, flip, rotaÈ›ie)
- [x] Control manual semafor (Emergency Stop)

### âœ… Analytics
- [x] Grafice trafic Ã®n timp real (Chart.js)
- [x] AnalizÄƒ Peak Hours
- [x] Heatmap trafic per orÄƒ/zi
- [x] Export date CSV È™i Excel
- [x] Integrare date meteo (OpenWeatherMap)
- [x] PredicÈ›ie trafic bazatÄƒ pe date istorice

### âœ… Database Logging
- [x] VehicleCount - Ãnregistrare numÄƒr vehicule
- [x] DetectionEvent - Evenimente detecÈ›ie
- [x] TrafficLightState - Istoric schimbÄƒri LED
- [x] SystemStats - Statistici zilnice
- [x] HourlyStats - Statistici orare

---

## FuncÈ›ionalitÄƒÈ›i Propuse pentru Viitor

### ğŸ”® ÃmbunÄƒtÄƒÈ›iri Sistem

| Feature                       | Descriere                                                      | Prioritate |
| ----------------------------- | -------------------------------------------------------------- | ---------- |
| **Multi-Camera Fusion**       | Combinare date de la multiple camere pentru acurateÈ›e mai mare | ÃnaltÄƒ     |
| **DetecÈ›ie Vehicule UrgenÈ›Äƒ** | Sirene, ambulanÈ›e, pompieri cu prioritate automatÄƒ             | ÃnaltÄƒ     |
| **Adaptive Learning**         | ML care Ã®nvaÈ›Äƒ pattern-uri locale de trafic                    | Medie      |
| **Night Mode**                | DetecÈ›ie Ã®mbunÄƒtÄƒÈ›itÄƒ pentru condiÈ›ii de luminÄƒ scÄƒzutÄƒ        | Medie      |
| **Speed Estimation**          | Estimare vitezÄƒ vehicule folosind optical flow                 | Medie      |

### ğŸ”® Hardware Extensii

| Feature                 | Descriere                                          | Prioritate |
| ----------------------- | -------------------------------------------------- | ---------- |
| **Senzori Inductivi**   | Backup pentru detecÈ›ie cÃ¢nd camera nu funcÈ›ioneazÄƒ | ÃnaltÄƒ     |
| **AfiÈ™aj LED Secundar** | Semafor pentru pietoni (verde/roÈ™u omuleÈ›)         | ÃnaltÄƒ     |
| **Senzor LuminÄƒ**       | Ajustare automatÄƒ luminozitate LED                 | Medie      |
| **Buton Fizic Pieton**  | Buton real pentru cerere traversare                | Medie      |
| **GPS Module**          | Sincronizare timp È™i locaÈ›ie exactÄƒ                | ScÄƒzutÄƒ    |

### ğŸ”® Software Features

| Feature                | Descriere                            | Prioritate |
| ---------------------- | ------------------------------------ | ---------- |
| **Mobile App**         | AplicaÈ›ie mobilÄƒ pentru monitorizare | ÃnaltÄƒ     |
| **Cloud Dashboard**    | Dashboard accesibil de oriunde       | Medie      |
| **Push Notifications** | AlertÄƒ cÃ¢nd trafic anormal sau erori | Medie      |
| **Voice Control**      | Control vocal pentru accesibilitate  | ScÄƒzutÄƒ    |
| **Integration MQTT**   | Comunicare cu alte sisteme IoT       | ScÄƒzutÄƒ    |

### ğŸ”® Analytics Avansate

| Feature                    | Descriere                                 | Prioritate |
| -------------------------- | ----------------------------------------- | ---------- |
| **Plate Recognition**      | RecunoaÈ™tere numere de Ã®nmatriculare      | ÃnaltÄƒ     |
| **Vehicle Classification** | Clasificare detaliatÄƒ (SUV, sedan, truck) | Medie      |
| **Queue Length**           | MÄƒsurare lungime coadÄƒ la semafor         | Medie      |
| **CO2 Estimation**         | Estimare emisii bazatÄƒ pe trafic          | ScÄƒzutÄƒ    |
| **Accident Detection**     | Detectare coliziuni sau blocaje           | ScÄƒzutÄƒ    |

---

## Diagrame Mermaid (pentru documentare)

### Diagrama Flux Date

```mermaid
flowchart TD
    A[Camera Module 3] -->|Frame video| B[OpenCV Capture]
    C[DroidCam Phone] -->|HTTP Stream| B
    B -->|640x480 frames| D[YOLOv8 Detector]
    D -->|Detections| E[Zone Counter]
    E -->|N/E/S/W counts| F[Traffic Controller]
    F -->|LED Command| G[LED Strip GPIO10]
    F -->|Stats| H[(SQLite DB)]
    F -->|JSON| I[Web Dashboard]
    
    J[Pedestrian Button] -->|Request| F
    
    style A fill:#e1f5fe
    style C fill:#e1f5fe
    style D fill:#fff3e0
    style F fill:#e8f5e9
    style G fill:#ffebee
    style H fill:#f3e5f5
    style I fill:#e0f2f1
```

### Diagrama Componente

```mermaid
graph TB
    subgraph Frontend
        A[Dashboard HTML]
        B[Analytics HTML]
        C[Settings HTML]
        D[JavaScript AJAX]
    end
    
    subgraph Backend
        E[Django Views]
        F[URL Router]
        G[Camera Module]
        H[Detector Module]
        I[Traffic Controller]
    end
    
    subgraph Hardware
        J[Camera Module 3]
        K[LED Strip WS2812B]
        L[GPIO 10]
    end
    
    subgraph Database
        M[(SQLite)]
    end
    
    A --> D
    B --> D
    C --> D
    D --> F
    F --> E
    E --> G
    E --> H
    E --> I
    G --> J
    I --> L
    L --> K
    E --> M
    
    style Frontend fill:#e3f2fd
    style Backend fill:#fff8e1
    style Hardware fill:#fce4ec
    style Database fill:#f3e5f5
```

---

## Concluzie

Sistemul Smart Traffic Light reprezintÄƒ o soluÈ›ie completÄƒ pentru controlul inteligent al semaforului bazat pe viziune computerizatÄƒ. Arhitectura modularÄƒ permite extinderea uÈ™oarÄƒ cu noi funcÈ›ionalitÄƒÈ›i, iar utilizarea tehnologiilor moderne (YOLOv8, Django, NeoPixel) asigurÄƒ performanÈ›Äƒ È™i fiabilitate.

**Autori:** Proiect SI - Master 2025  
**Versiune:** Beta v3  
**Ultima actualizare:** Ianuarie 2025
